### Solidity의 Gas에 대한 이해

이더리움에서 Gas는 스마트 계약과 트랜잭션을 실행하는 데 필요한 비용을 측정하는 단위입니다.
Gas는 이더리움 네트워크의 운영을 원활하게 하고, 네트워크를 악의적인 활동으로부터 보호하는 역할을 합니다.

### Gas의 기본 개념

1. **Gas**: 컴퓨팅 작업을 수행하는 데 필요한 단위입니다. 이더리움 네트워크에서 코드 실행, 데이터 저장, 데이터 전송 등의 모든 작업은 일정량의 Gas를 소비합니다.
2. **Gas Price**: Gas의 단위당 비용을 의미합니다. 이는 트랜잭션을 실행하기 위해 지불할 의사가 있는 이더의 양을 나타냅니다. `gwei` 단위로 측정됩니다.
3. **Gas Spent**: 특정 트랜잭션에서 실제로 사용된 Gas의 총량입니다.
4. **Gas Limit**: 트랜잭션에서 사용자가 설정하는 최대 Gas 한도입니다. 이는 트랜잭션이 실패하는 것을 방지하고, 예상치 못한 비용을 제한하는 데 사용됩니다.

### Gas 비용 계산

트랜잭션 비용은 다음과 같이 계산됩니다.

$$ \text{총 트랜잭션 비용 (ether)} = \text{Gas Spent} \times \text{Gas Price} $$

### Gas의 중요성

- **트랜잭션 우선순위**: Gas Price가 높을수록 트랜잭션이 우선 처리될 가능성이 높아집니다. 이는 네트워크 혼잡 시 중요한 트랜잭션이 빠르게 처리되도록 보장합니다.
- **미사용 Gas 환불**: 트랜잭션 실행 중 사용되지 않은 Gas는 환불됩니다. 이는 사용자가 설정한 Gas Limit 내에서 실제로 소비된 Gas만 지불하도록 합니다.

### Gas Limit

1. **개인 트랜잭션 Gas Limit**: 사용자가 특정 트랜잭션에서 사용할 최대 Gas 양을 설정합니다. 이는 트랜잭션이 너무 많은 Gas를 소비하지 않도록 보호하는 역할을 합니다.
2. **블록 Gas Limit**: 네트워크 전체에서 하나의 블록에 포함될 수 있는 최대 Gas 양을 제한합니다. 이는 블록의 크기를 제어하고, 네트워크의 안정성을 유지하는 데 중요합니다.

### 예제 코드

아래는 Gas의 사용과 관련된 예제 코드입니다:

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.24;

contract Gas {
    uint256 public i = 0;

    // 모든 Gas를 사용하게 되면 트랜잭션이 실패합니다.
    // 상태 변경은 원래대로 되돌려집니다.
    // 사용된 Gas는 환불되지 않습니다.
    function forever() public {
        // 무한 루프를 실행하여 모든 Gas를 소진시키고 트랜잭션을 실패시킵니다.
        while (true) {
            i += 1;
        }
    }
}
```

#### 예제 코드 설명

1. **Gas 소진**: `forever` 함수는 무한 루프를 실행하여 Gas를 소진시킵니다. 이 함수는 모든 Gas를 사용하게 되어 결국 트랜잭션이 실패하게 됩니다.
2. **트랜잭션 실패**: Gas를 모두 사용하면 트랜잭션이 실패하고, 상태 변경은 원래대로 되돌려집니다. 그러나 사용된 Gas는 환불되지 않습니다.

### Remix 실습

1. [Remix IDE](https://remix.ethereum.org/)에 접속합니다.
2. 새 파일을 만들어 위 예제 코드를 복사하여 붙여넣고 파일을 저장합니다.
3. 좌측 메뉴에서 "Solidity 컴파일러"를 이용해 코드를 컴파일하고, Deploy합니다.

##### 기능확인

- **초기 상태 확인**
    - 배포 직후, `i` 변수가 0으로 초기화되어 있는지 확인합니다.
    - `i` 변수가 `0`인지 확인하려면 `i` 버튼을 클릭하여 값을 확인합니다.

- **Gas 소진 테스트**
    - 배포된 컨트랙트 인스턴스에서 `forever` 함수를 실행합니다.
    - `forever` 버튼을 클릭하여 트랜잭션을 전송합니다.
    - 트랜잭션이 실패할 때까지 기다립니다.

- **상태 확인**
    - 트랜잭션이 실패한 후, `i` 변수가 여전히 `0`인지 확인합니다.
    - `i` 변수가 변경되지 않았는지 확인하려면 `i` 버튼을 다시 클릭하여 값을 확인합니다.

![image](https://github.com/Joon2000/Solidity-modules/assets/69339099/e0f083d5-e2d4-4e7c-9d27-c58611babfd9)

![image](https://github.com/Joon2000/Solidity-modules/assets/69339099/e25eb7db-1f8e-4937-b683-8bfdf1727d2f)

![image](https://github.com/Joon2000/Solidity-modules/assets/69339099/8a2d39df-5c5e-40e0-8bb7-1579bc806c09)


